<!doctype html>
<html ng-app='PyArduino'>
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet"
	href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet"
	href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css">

<link rel="stylesheet" href="/static/app/angular-slider.css">

<script src="//code.jquery.com/jquery.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script
	src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js"></script>

<script src="/static/app/ui-bootstrap-tpls-0.6.0.min.js"></script>

<script src="/static/app/angular-slider.js"></script>

<script src="/static/app/controllers.js"></script>

<style type="text/css">
INPUT.pin_label {
	height: 24px;
	line-height: 1;
	padding-left: 2px;
}

INPUT.pin_io_value {
	height: 24px;
	line-height: 1;
	padding-left: 2px;
	width: 4em;
}
</style>

</head>
<body ng-controller="GlobalController">

	<!-- Fixed navbar -->
	<div class="navbar navbar-default navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target=".navbar-collapse">
					<span class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">py-arduino</a>
			</div>
			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li class="active"><a href="#">Home</a></li>
					<li><a href="#about">About</a></li>
					<li><a href="#contact">Contact</a></li>
					<li class="dropdown"><a href="#" class="dropdown-toggle"
						data-toggle="dropdown">Dropdown <b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="#">Action</a></li>
							<li><a href="#">Another action</a></li>
							<li><a href="#">Something else here</a></li>
							<li class="divider"></li>
							<li class="dropdown-header">Nav header</li>
							<li><a href="#">Separated link</a></li>
							<li><a href="#">One more separated link</a></li>
						</ul></li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<li><a href="../navbar/">Default</a></li>
					<li><a href="../navbar-static-top/">Static top</a></li>
					<li class="active"><a href="./">{{extras.avr_cpu_type}}</a></li>
				</ul>
			</div>
			<!--/.nav-collapse -->
		</div>
	</div>

	<div class="container" style="padding-top: 70px;">

		<div ng-controller="PinsController" ng-init="refreshPinInfo()">

			<table class="table table-condensed table-hover">

				<tr>
					<th><a href="javascript:void(0);" data-toggle="tooltip"
						title="Indicates pins with PWM support"><span
							class="glyphicon glyphicon-question-sign"></span></a></th>
					<th colspan="2">Pin #</th>
					<th>&nbsp;</th>
					<th>Mode</th>
					<th>IO</th>
				</tr>

				<!--
            // .... .... "pwm": false,
            // .... .... "enabled_in_web": true,
            // .... .... "pin": 0,
            // .... .... "pin_id": null,
            // .... .... "status_written_value": null,
            // .... .... "status_read_value": null,
            // .... .... "status_mode": null,
            // .... .... "digital": true,
            // .... .... "pk": 1,
            // .... .... "label": "Digital pin #0"
            -->

				<tr
					ng-repeat="pin_struct in enhanced_arduino_type.digital_pins_struct">

					<td width="1%">
						<!-- PWM: {{ pin_struct.pwm }} --> <a href="javascript:void(0);"
						ng-show="pin_struct.pwm" data-toggle="tooltip"
						title="This pin has PWM support"><span
							class="glyphicon glyphicon-ok-circle"></span></a>
					</td>

					<td width="1%" style="text-align: right;">D{{pin_struct.pin}}</td>

					<td width="37%"><a href="javascript:void(0);"
						ng-show="! editMode">{{pin_struct.label}}</a> <input type="text"
						ng-model="pin_struct.label" class="col-lg-3 input-sm pin_label"
						ng-show="editMode" /></td>

					<td width="1%"><a href="javascript:void(0);"
						ng-show="! pin_struct.enabled_in_web" data-toggle="tooltip"
						title="This pin is configured to not be modified from web interface"
						style="margin-left: 4px;"><span
							class="glyphicon glyphicon-question-sign"></span></a></td>

					<td width="50%">
						<div class="btn-group btn-group-xs" style="float: left;">
							<button ng-disabled="! pin_struct.enabled_in_web" type="button"
								ng-click="pinModeDisabled(pin_struct)" class="btn"
								ng-class="pin_struct.css_for_button_unknown_mode">X</button>

							<button ng-disabled="! pin_struct.enabled_in_web" type="button"
								ng-click="pinModeInput(pin_struct)" class="btn"
								ng-class="pin_struct.css_for_button_input_mode">INPUT</button>

							<button ng-disabled="! pin_struct.enabled_in_web" type="button"
								ng-click="pinModeOutput(pin_struct)" class="btn"
								ng-class="pin_struct.css_for_button_output_mode">OUTPUT</button>
						</div>
						<div style="float: right;">

							<!-- *** READ *** BUTTON to read  value  -->
							<button ng-disabled="! pin_struct.enabled_in_web" type="button"
								ng-click="readPin(pin_struct)" class="btn btn-primary btn-xs"
								ng-show="pin_struct.status.mode_is_input">Read</button>

							<!-- *** WRITE *** INPUT text to write PWM values  -->
							<input type="text" ng-model="pin_struct._tmp_analog_write"
								class="input-sm pin_io_value"
								ng-show="pin_struct.status.mode_is_output && pin_struct.pwm" />
							<!--  -->

							<!-- *** WRITE *** BUTTON to write PWM value  -->
							<button ng-disabled="! pin_struct.enabled_in_web" type="button"
								ng-click="analogWrite(pin_struct, pin_struct._tmp_analog_write)"
								class="btn btn-primary btn-xs"
								ng-show="pin_struct.status.mode_is_output && pin_struct.pwm">Write
								PWM</button>

							<!-- *** WRITE *** BUTTON to write LOW  -->
							<button ng-disabled="! pin_struct.enabled_in_web" type="button"
								ng-click="digitalWrite(pin_struct, CONST.LOW)"
								class="btn btn-primary btn-xs"
								ng-show="pin_struct.status.mode_is_output">Write LOW</button>

							<!-- *** WRITE *** BUTTON to write HIGH  -->
							<button ng-disabled="! pin_struct.enabled_in_web" type="button"
								ng-click="digitalWrite(pin_struct, CONST.HIGH)"
								class="btn btn-primary btn-xs"
								ng-show="pin_struct.status.mode_is_output">Write HIGH</button>

						</div>

					</td>

					<td width="10%">
						<!-- <slider floor="0" ceiling="1023" step="1" precision="1"
							ng-model="pin_struct.xxxxxxxxxxxxxxxxxxxxx" ng-show="pin_struct.pwm"></slider> -->

						<!-- *** READ *** badge to show read value (when 'read_value' is a valid number) -->
						<span class="label label-default"
						ng-show="pin_struct.status.read_value|is_number">{{pin_struct.status.read_value|as_high_low}}</span>

						<!-- *** WRITE *** badge to show written value (when OUTPUT but NOT pwm) -->
						<span class="label label-default"
						ng-show="pin_struct.status.mode_is_output && ! pin_struct.pwm">{{pin_struct.status.written_value|as_high_low}}</span>

						<!-- *** WRITE *** badge to show written value (when OUTPUT is pwm) -->
						<span class="label label-default"
						ng-show="pin_struct.status.mode_is_output && pin_struct.pwm">{{pin_struct|written_pwm_value}}</span>

					</td>

				</tr>

				<!--
            // "analog_pins_struct": [
            // .... {
            // .... "pwm": false,
            // .... "enabled_in_web": true,
            // .... "pin": 0,
            // .... "pin_id": null,
            // .... "status_written_value": null,
            // .... "status_read_value": null,
            // .... "status_mode": null,
            // .... "digital": true,
            // .... "pk": 55,
            // .... "label": "Analog pin #0"
            // .... },
            -->

				<tr
					ng-repeat="pin_struct in enhanced_arduino_type.analog_pins_struct">

					<td>
						<!-- PWM: {{ pin_struct.pwm }} --> <span
						class="glyphicon glyphicon-ok-circle" ng-show="pin_struct.pwm"></span>
					</td>

					<td style="text-align: right;">A{{pin_struct.pin}}</td>

					<td><a href="javascript:void(0);" ng-show="! editMode">{{pin_struct.label}}</a>
						<input type="text" ng-model="pin_struct.label"
						class="col-lg-3 input-sm pin_label" ng-show="editMode" /></td>

					<td><a href="javascript:void(0);"
						ng-show="! pin_struct.enabled_in_web" data-toggle="tooltip"
						title="This pin is configured to not be modified from web interface"
						style="margin-left: 4px;"><span
							class="glyphicon glyphicon-question-sign"></span></a></td>

					<td>
						<div style="float: right;">
							<button ng-disabled="! pin_struct.enabled_in_web" type="button"
								ng-click="readPin(pin_struct)" class="btn btn-primary btn-xs">Read</button>
						</div>
					</td>

					<td><span class="label label-default"
						ng-show="pin_struct.status.read_value|is_number">{{pin_struct.status.read_value}}</span>
					</td>

				</tr>

			</table>

			<button class="btn btn-primary" ng-click="refreshPinInfo()" ng-show="! editMode">
				<span class="glyphicon glyphicon-refresh"></span> Refresh
			</button>

			<button class="btn btn-primary" ng-click="editModeEnter()"
				ng-show="! editMode">
				<span class="glyphicon glyphicon-pencil"></span> Edit labels
			</button>

			<button class="btn btn-danger" ng-click="editModeExit()"
				ng-show="editMode">
				<span class="glyphicon glyphicon-ok"></span> Finish edition
			</button>

		</div>

	</div>
	<!-- /container -->

</body>
</html>
