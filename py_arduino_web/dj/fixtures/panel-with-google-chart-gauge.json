[
{
  "pk": 1, 
  "model": "dj.controlpanel", 
  "fields": {
    "html": "<div id=\"chart_div\"></div>\r\n\r\n<hr>\r\n\r\n<div ng-controller=\"MyPanel\" ng-init=\"init()\">\r\n\r\n    <div style=\"padding-top: 2px;\">\r\n\t    <button class=\"btn btn-primary\" ng-click=\"refreshPinInfo2()\">Refresh values</button>\r\n\t    <button type=\"button\" ng-click=\"startAutoRefresh2()\"\r\n\t        class=\"btn btn-primary\" ng-show=\"! extras.intervalAutoRefresh\">Start auto-refresh</button>\r\n\t    <button type=\"button\" ng-click=\"stopAutoRefresh2()\" class=\"btn btn-primary\"\r\n\t        ng-show=\"extras.intervalAutoRefresh\">Stop  auto-refresh</button>\r\n    </div>\r\n\r\n    <!--\r\n    <div>\r\n        <span ng-repeat=\"pin_struct in enhanced_arduino_type.digital_pins_struct\">\r\n            <small>\r\n                <span style=\"padding: 0.2em;\">[D{{pin_struct.pin}}]</span>\r\n            </small>\r\n        </span>\r\n    </div>\r\n    -->\r\n\r\n    <div>\r\n        <span ng-repeat=\"pin_struct in enhanced_arduino_type.analog_pins_struct\">\r\n            <span ng-show=\"pin_struct.status.read_value|is_number\" style=\"padding: 0.2em;\">\r\n                <small>\r\n                    A{{pin_struct.pin}}: \r\n                    <span class=\"label label-default\">{{pin_struct.status.read_value}}</span>\r\n                </small>\r\n            </span>\r\n        </span>\r\n    </div>\r\n\r\n</div>", 
    "name": "default", 
    "js": "\r\nfunction MyPanel($scope, $interval) {\r\n    $scope.mypanel = {msg: \"Hola!\"};\r\n\r\n    $scope.googleChart = {};\r\n\r\n    $scope.init = function() {\r\n        $scope.drawChart();\r\n        // $scope.refreshPinInfo();\r\n    };\r\n\r\n    $scope.drawChart = function() {\r\n        $scope.googleChart.data = google.visualization.arrayToDataTable([\r\n          ['Label', 'Value'],\r\n          ['A0', 0],\r\n          ['A1', 0],\r\n        ]);\r\n        \r\n        $scope.googleChart.options = {\r\n          width: 400, height: 120,\r\n          yellowFrom:512, yellowTo: 768,\r\n          redFrom: 769, redTo: 1024,\r\n          minorTicks: 10, max: 1024\r\n        };\r\n\r\n        $scope.googleChart.chart = new google.visualization.Gauge(document.getElementById('chart_div'));\r\n        $scope.googleChart.chart.draw($scope.googleChart.data, $scope.googleChart.options);\r\n    };\r\n\r\n    $scope.updateChart = function() {\r\n        // setValue() -> row, column, value\r\n        $scope.googleChart.data.setValue(0, 1, $scope.enhanced_arduino_type.analog_pins_struct[0].status.read_value);\r\n        $scope.googleChart.data.setValue(1, 1, $scope.enhanced_arduino_type.analog_pins_struct[1].status.read_value);\r\n        $scope.googleChart.chart.draw($scope.googleChart.data, $scope.googleChart.options);\r\n    };\r\n\r\n    /*\r\n     * autoRefresh\r\n     */\r\n\r\n    // $scope.getBackgroundProcessesStatus\r\n    $scope.startAutoRefresh2 = function() {\r\n        if ($scope.extras.intervalAutoRefresh)\r\n            return;\r\n        $scope.extras.intervalAutoRefresh = $interval(function() {\r\n            $scope.refreshPinInfo2();\r\n        }, 2000);\r\n    };\r\n\r\n    $scope.stopAutoRefresh2 = function() {\r\n        console.info(\"stopAutoRefresh()\");\r\n        $interval.cancel($scope.extras.intervalAutoRefresh);\r\n        $scope.extras.intervalAutoRefresh = null;\r\n    };\r\n\r\n    $scope.refreshPinInfo2 = function() {\r\n        $scope.refreshPinInfo($scope.updateChart);\r\n    };\r\n}\r\n\r\ngoogle.load('visualization', '1', {packages:['gauge']});\r\n\r\ngoogle.setOnLoadCallback(function() {\r\n    angular.bootstrap(document.body, ['PyArduino']);\r\n});\r\n"
  }
}
]
