[
{
  "pk": 1, 
  "model": "dj.controlpanel", 
  "fields": {
    "header": "<link rel=\"stylesheet\" href=\"/static/local/jquery.jqplot.1.0.8r1250/jquery.jqplot.css\">\n<script src=\"/static/local/jquery.jqplot.1.0.8r1250/jquery.jqplot.js\"></script>\n<script src=\"/static/local/jquery.jqplot.1.0.8r1250/plugins/jqplot.meterGaugeRenderer.min.js\"></script>\n", 
    "html": "<div id=\"chart0\" style=\"width: 300px; heigth: 200px;\"></div>\r\n\r\n<div id=\"chart1\" style=\"width: 300px; heigth: 200px;\"></div>\r\n\r\n<div id=\"chart2\" style=\"width: 300px; heigth: 200px;\"></div>\r\n\r\n<hr>\r\n\r\n<div ng-controller=\"MyPanel\" ng-init=\"init()\">\r\n\r\n    <div style=\"padding-top: 2px;\">\r\n\t    <button class=\"btn btn-primary\" ng-click=\"refreshPinInfo2()\">Refresh values</button>\r\n\t    <button type=\"button\" ng-click=\"startAutoRefresh2()\"\r\n\t        class=\"btn btn-primary\" ng-show=\"! extras.intervalAutoRefresh\">Start auto-refresh</button>\r\n\t    <button type=\"button\" ng-click=\"stopAutoRefresh2()\" class=\"btn btn-primary\"\r\n\t        ng-show=\"extras.intervalAutoRefresh\">Stop  auto-refresh</button>\r\n    </div>\r\n\r\n    <!--\r\n    <div>\r\n        <span ng-repeat=\"pin_struct in enhanced_arduino_type.digital_pins_struct\">\r\n            <small>\r\n                <span style=\"padding: 0.2em;\">[D{{pin_struct.pin}}]</span>\r\n            </small>\r\n        </span>\r\n    </div>\r\n    -->\r\n\r\n    <div>\r\n        <span ng-repeat=\"pin_struct in enhanced_arduino_type.analog_pins_struct\">\r\n            <span ng-show=\"pin_struct.status.read_value|is_number\" style=\"padding: 0.2em;\">\r\n                <small>\r\n                    A{{pin_struct.pin}}: \r\n                    <span class=\"label label-default\">{{pin_struct.status.read_value}}</span>\r\n                </small>\r\n            </span>\r\n        </span>\r\n    </div>\r\n\r\n</div>", 
    "name": "default", 
    "js": "\r\nfunction MyPanel($scope, $interval, remoteArduino) {\r\n\r\n    $scope.jqPlot = {};\r\n\r\n    $scope.init = function() {\r\n        $scope.drawInitialChart();\r\n        // $scope.refreshPinInfo();\r\n    };\r\n\r\n    $scope.drawInitialChart = function() {\r\n        // $scope.jqPlot.serie0 = [0];\r\n        \r\n        $scope.jqPlot.plot0 = $.jqplot('chart0', [[0]], {\r\n            // title: 'Network Speed',\r\n            seriesDefaults: {\r\n                renderer: $.jqplot.MeterGaugeRenderer,\r\n                rendererOptions: {\r\n                    min: 0,\r\n                    max: 1023,\r\n                    // intervals: [256, 512, 768, 900],\r\n                    // intervalColors: ['#66cc66', '#93b75f', '#E7E658', '#cc6666'],\r\n                    label: 'Analog pin'\r\n                }\r\n            }\r\n        });\r\n\r\n        $scope.jqPlot.plot1 = $.jqplot('chart1', [[0]], {\r\n            // title: 'Network Speed',\r\n            seriesDefaults: {\r\n                renderer: $.jqplot.MeterGaugeRenderer,\r\n                rendererOptions: {\r\n                    min: 150,\r\n                    max: 300,\r\n                    intervals: [210, 220, 230, 240, 300],\r\n                    intervalColors: ['#cc6666', '#E7E658', '#93b75f', '#E7E658', '#cc6666'],\r\n                    label: 'Volts'\r\n                }\r\n            }\r\n        });\r\n\r\n        $scope.jqPlot.plot2 = $.jqplot('chart2', [[0]], {\r\n            // title: 'Network Speed',\r\n            seriesDefaults: {\r\n                renderer: $.jqplot.MeterGaugeRenderer,\r\n                rendererOptions: {\r\n                    min: 0,\r\n                    max: 50,\r\n                    intervals: [10, 40, 50],\r\n                    intervalColors: ['#E7E658', '#93b75f', '#cc6666'],\r\n                    label: 'Amp'\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    $scope.updateChart = function() {\r\n        console.info(\"updateChart() / plot0 -> \" + $scope.enhanced_arduino_type.analog_pins_struct[0].status.read_value);\r\n        $scope.jqPlot.plot0.series[0].data[0] = [1, $scope.enhanced_arduino_type.analog_pins_struct[0].status.read_value];\r\n        $scope.jqPlot.plot0.replot();\r\n\r\n        console.info(\"updateChart() / plot1+plot2 -> \" + $scope.enhanced_arduino_type.analog_pins_struct[1].status.lib_read_value);\r\n        if($scope.enhanced_arduino_type.analog_pins_struct[1].status.lib_read_value !== null) {\r\n            $scope.jqPlot.plot1.series[0].data[0] = [1, $scope.enhanced_arduino_type.analog_pins_struct[1].status.lib_read_value.Vrms];\r\n            $scope.jqPlot.plot1.replot();\r\n            $scope.jqPlot.plot2.series[0].data[0] = [1, $scope.enhanced_arduino_type.analog_pins_struct[1].status.lib_read_value.Irms];\r\n            $scope.jqPlot.plot2.replot();\r\n        }\r\n    };\r\n\r\n    /*\r\n     * autoRefresh\r\n     */\r\n\r\n    // $scope.getBackgroundProcessesStatus\r\n    $scope.startAutoRefresh2 = function() {\r\n        if ($scope.extras.intervalAutoRefresh)\r\n            return;\r\n        $scope.extras.intervalAutoRefresh = $interval(function() {\r\n            $scope.refreshPinInfo2();\r\n        }, 2000);\r\n    };\r\n\r\n    $scope.stopAutoRefresh2 = function() {\r\n        console.info(\"stopAutoRefresh()\");\r\n        $interval.cancel($scope.extras.intervalAutoRefresh);\r\n        $scope.extras.intervalAutoRefresh = null;\r\n    };\r\n\r\n    $scope.refreshPinInfo2 = function() {\r\n        $scope.refreshPinInfo($scope.updateChart);\r\n    };\r\n}\r\n\r\n$(document).ready(function() {\r\n    angular.bootstrap(document.body, ['PyArduino']);\r\n});\r\n"
  }
}
]
